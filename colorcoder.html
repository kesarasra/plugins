<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ColorCoder</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<style>
body { padding: 2rem; }
.swatch { position: relative; width: 100%; height: 80px; border-radius: .5rem; box-shadow: 0 2px 8px rgba(0,0,0,0.12); cursor: pointer; }
.copy-icon { position: absolute; top: 6px; right: 8px; background: rgba(255,255,255,0.8); border-radius: 4px; padding: 2px 6px; font-size: 0.8rem; cursor: pointer; transition: background .2s; }
.copy-icon:hover { background: rgba(255,255,255,1); }
.mono-swatch { display:flex; gap:8px; }
.mono-swatch > div { flex:1; height:48px; border-radius:6px; cursor:pointer; position:relative; }
.copied-badge { position:absolute; bottom:4px; right:6px; font-size:0.7rem; background:rgba(0,0,0,0.6); color:#fff; padding:2px 4px; border-radius:3px; opacity:0; transition:opacity .3s; }
.copied-badge.show { opacity:1; }
.code-block { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, 'Roboto Mono', monospace; font-size: .9rem; }
.text-palette div { cursor:pointer; }
body h4 { font-size: 1.5rem; }
</style>
</head>
<body class="bg-gray-50">
<div class="container">
<h1 class="mb-3 text-2xl font-bold tracking-widest">Color Coder</h1>
<p class="lead p-2">Pick a background color and see its complementary element color, shades, codes, greyscale, and font recommendations.
                Click on a swatch to copy to clipboard.
</p>

<div class="row gy-3">
<div class="col-md-4">
  <div class="card p-3">
    <label class="form-label">Choose primary (background) color</label>
    <input id="colorInput" type="color" class="form-control form-control-color" value="#3b82f6">
    <label class="form-label mt-3">Hex / input</label>
    <input id="hexInput" class="form-control" placeholder="#3b82f6">
    <button id="applyHex" class="btn btn-primary mt-2">Apply HEX</button>
  </div>

  <div class="card p-3">
    <h4 class="mt-3 py-2">Font weight recommendations</h4>
    <ul id="fontWeights">
      <li style="font-weight: 700;">h1: 700 (bold)</li>
      <li style="font-weight: 600;">h2: 600 (semibold)</li>
      <li style="font-weight: 500;">h3: 500 (medium)</li>
      <li style="font-weight: 400;">p: 400 (regular)</li>
    </ul>
    <h4 class="mt-3 py-2">Font size recommendations</h4>
    <ul id="fontSizes">
      <li class="text-5xl">h1: 3rem</li>
      <li class="text-3xl">h2: 1.875rem</li>
      <li class="text-xl">h3: 1.25rem</li>
      <li class="text-base">p: 1rem</li>
    </ul>
  </div>
</div>

<div class="col-md-8">
  <div class="card p-3 mb-3">
    <div class="row">
      <div class="col-md-6">
        <label class="form-label">Primary (Background)</label>
        <div id="selSwatch" class="swatch mb-2"><div class="copy-icon">Copy</div></div>
        <pre id="selCodes" class="code-block p-2 bg-white rounded">/* color codes */</pre>
      </div>
      <div class="col-md-6">
        <label class="form-label">Secondary (Element)</label>
        <div id="compSwatch" class="swatch mb-2"><div class="copy-icon">Copy</div></div>
        <pre id="compCodes" class="code-block p-2 bg-white rounded">/* complement codes */</pre>
      </div>
    </div>
  </div>

  <div class="card p-3 mb-3">
    <h5>Shades (primary color)</h5>
    <div id="shadesRow" class="d-flex mt-2 gap-2 flex-wrap"></div>
  </div>

  <div class="card p-3 mb-3">
    <h5>Shades (secondary color)</h5>
    <div id="shadesCompRow" class="d-flex mt-2 gap-2 flex-wrap"></div>
  </div>

  <div class="card p-3 mb-3">
    <h5>Greyscale suggestions</h5>
    <div id="monoRow" class="mono-swatch mt-2"></div>
  </div>
</div>
</div>

<div class="card p-3 mt-4">
<h5 class="p-2">Preview (auto text color + font stack)</h5>
<button id="toggleColor" class="btn btn-sm btn-secondary mb-2">Toggle Text Color (Primary/Element)</button>
<div id="preview" class="p-3 rounded">
  <h1 id="p-h1" class="mb-2">Heading 1 — ColorCoder</h1>
  <h2 id="p-h2" class="mb-2">Heading 2 — Subheading</h2>
  <h3 id="p-h3" class="mb-2">Heading 3 — Smaller</h3>
  <p id="p-p">This is a paragraph example. The app suggests readable text color and hierarchy automatically.</p>
</div>
</div>
</div>

<script>
// --- Utility functions ---
function hexToRgb(hex){const h=hex.replace('#','');const bigint=parseInt(h,16);return{r:(bigint>>16)&255,g:(bigint>>8)&255,b:bigint&255}}
function rgbToHex(r,g,b){return'#'+[r,g,b].map(x=>x.toString(16).padStart(2,'0')).join('')}
function rgbToHsl(r,g,b){r/=255;g/=255;b/=255;const max=Math.max(r,g,b),min=Math.min(r,g,b);let h,s,l=(max+min)/2;if(max===min){h=s=0}else{const d=max-min;s=l>.5?d/(2-max-min):d/(max+min);switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;}h/=6}return{h:Math.round(h*360),s:Math.round(s*100),l:Math.round(l*100)}}
function hslToRgb(h,s,l){h/=360;s/=100;l/=100;let r,g,b;if(s===0){r=g=b=l}else{const hue2rgb=(p,q,t)=>{if(t<0)t+=1;if(t>1)t-=1;if(t<1/6)return p+(q-p)*6*t;if(t<1/2)return q;if(t<2/3)return p+(q-p)*(2/3-t)*6;return p};const q=l<.5?l*(1+s):l+s-l*s;const p=2*l-q;r=hue2rgb(p,q,h+1/3);g=hue2rgb(p,q,h);b=hue2rgb(p,q,h-1/3);}return{r:Math.round(r*255),g:Math.round(g*255),b:Math.round(b*255)}}
function toRgbString(rgb){return`rgb(${rgb.r}, ${rgb.g}, ${rgb.b})`}
function luminance({r,g,b}){const a=[r,g,b].map(v=>v/255<=0.03928?v/255/12.92:Math.pow((v/255+0.055)/1.055,2.4));return a[0]*0.2126+a[1]*0.7152+a[2]*0.0722}
function contrastColor(rgb){return luminance(rgb)>0.5?'#000':'#fff'}

// --- Smart complementary element color ---
function smartComplement(h,s,l){
  const compH=(h+180)%360;
  let compL;
  if(l<40) compL=Math.min(100,l+30);
  else if(l>70) compL=Math.max(0,l-30);
  else compL=l<55?l+20:l-20;
  return hslToRgb(compH,s,compL);
}

// --- Generate shades ---
function generateShades(h,s,l,count=5){
  const steps=[];const spread=30;const step=spread/(count-1);const start=l-spread/2;
  for(let i=0;i<count;i++){let Li=Math.max(0,Math.min(100,Math.round(start+i*step)));const rgb=hslToRgb(h,s,Li);steps.push({h,s,l:Li,rgb,hex:rgbToHex(rgb.r,rgb.g,rgb.b)})}
  return steps;
}

// --- Copy helper ---
function copyToClipboard(text,el){navigator.clipboard.writeText(text);const badge=document.createElement('div');badge.textContent='Copied';badge.className='copied-badge show';el.appendChild(badge);setTimeout(()=>badge.remove(),1000)}

// --- Text shade generator ---
function generateTextShades(bgRgb, baseRgb, count=5){
  const hsl=rgbToHsl(baseRgb.r,baseRgb.g,baseRgb.b);
  const shades=[];const spread=20;const step=spread/(count-1);
  for(let i=0;i<count;i++){
    let l=Math.max(0,Math.min(100,hsl.l-spread/2+i*step));
    const rgb=hslToRgb(hsl.h,hsl.s,l);
    if(luminanceContrast(bgRgb,rgb)>=4.5) shades.push({rgb,hex:rgbToHex(rgb.r,rgb.g,rgb.b)});
  }
  return shades;
}
function luminanceContrast(bg,fg){const L1=luminance(bg),L2=luminance(fg);return (Math.max(L1,L2)+0.05)/(Math.min(L1,L2)+0.05)}

// --- Render mini palettes under preview text ---
function renderTextPalettes(primaryRgb, compRgb){
  const preview=document.getElementById('preview');
  const textEls=[
    {id:'p-h1', baseColor:compRgb},
    {id:'p-h2', baseColor:compRgb},
    {id:'p-h3', baseColor:compRgb},
    {id:'p-p', baseColor:contrastColor(compRgb)}
  ];
  textEls.forEach(el=>{
    const dom=document.getElementById(el.id);
    const old=dom.querySelector('.text-palette'); if(old) old.remove();
    const palette=document.createElement('div');
    palette.className='d-flex gap-1 mt-1 text-palette';
    const shades=generateTextShades(primaryRgb,el.baseColor,5);
    shades.forEach(s=>{
      const d=document.createElement('div');
      d.style.width='24px'; d.style.height='16px'; d.style.borderRadius='3px';
      d.style.background=s.hex; d.title=s.hex; d.onclick=()=>copyToClipboard(s.hex,d);
      palette.appendChild(d);
    });
    dom.appendChild(palette);
  });
}

// --- Main update ---
let showElementColor=true;
function updateAll(hex){
  try{
    if(!/^#?[0-9A-Fa-f]{6}$/.test(hex))throw new Error('bad hex');
    if(hex[0]!=='#')hex='#'+hex;
    document.getElementById('colorInput').value=hex;
    document.getElementById('hexInput').value=hex;

    const rgb=hexToRgb(hex);
    const hsl=rgbToHsl(rgb.r,rgb.g,rgb.b);
    const compRgb=smartComplement(hsl.h,hsl.s,hsl.l);
    const compHex=rgbToHex(compRgb.r,compRgb.g,compRgb.b);

    // update swatches
    const selSwatch=document.getElementById('selSwatch');
    const compSwatch=document.getElementById('compSwatch');
    selSwatch.style.background=hex;
    compSwatch.style.background=compHex;
    selSwatch.querySelector('.copy-icon').onclick=()=>copyToClipboard(hex,selSwatch);
    compSwatch.querySelector('.copy-icon').onclick=()=>copyToClipboard(compHex,compSwatch);

    document.getElementById('selCodes').innerText=`HEX: ${hex}\nRGB: ${toRgbString(rgb)}\nHSL: hsl(${hsl.h}, ${hsl.s}%, ${hsl.l}%)`;
    document.getElementById('compCodes').innerText=`HEX: ${compHex}\nRGB: ${toRgbString(compRgb)}\nHSL: hsl(${(hsl.h+180)%360}, ${hsl.s}%, ${hsl.l}%)`;

    // shades
    const shades=generateShades(hsl.h,hsl.s,hsl.l,5);
    const shadesComp=generateShades((hsl.h+180)%360,hsl.s,hsl.l,5);
    const shadesRow=document.getElementById('shadesRow'); shadesRow.innerHTML='';
    const shadesCompRow=document.getElementById('shadesCompRow'); shadesCompRow.innerHTML='';
    shades.forEach(s=>{const d=document.createElement('div');d.style.width='80px';d.style.height='48px';d.style.borderRadius='6px';d.style.background=s.hex;d.title=s.hex;d.onclick=()=>copyToClipboard(s.hex,d);shadesRow.appendChild(d)});
    shadesComp.forEach(s=>{const d=document.createElement('div');d.style.width='80px';d.style.height='48px';d.style.borderRadius='6px';d.style.background=s.hex;d.title=s.hex;d.onclick=()=>copyToClipboard(s.hex,d);shadesCompRow.appendChild(d)});

    // grayscale
    const monoRow=document.getElementById('monoRow'); monoRow.innerHTML='';
    [20,40,60,80,95].forEach(g=>{const grayRgb=hslToRgb(0,0,g);const gray=rgbToHex(grayRgb.r,grayRgb.g,grayRgb.b);const el=document.createElement('div');el.style.background=gray;el.onclick=()=>copyToClipboard(gray,el);monoRow.appendChild(el)});

    // preview
    const preview=document.getElementById('preview');
    preview.style.background=hex;
    const bgTextColor=contrastColor(rgb);

    const texts=['p-h1','p-h2','p-h3','p-p'];
    const fontWeights=[700,600,500,400];
    const fontSizes=[3,1.875,1.25,1];
    texts.forEach((id,i)=>{
      const el=document.getElementById(id);
      el.style.fontWeight=fontWeights[i];
      el.style.fontSize=fontSizes[i]+'rem';
      el.style.color=showElementColor?(id==='p-p'?contrastColor(compRgb):compHex):bgTextColor;
    });

    renderTextPalettes(rgb,compRgb);

  }catch(e){console.warn('update error',e);}
}

// --- Events ---
document.getElementById('colorInput').addEventListener('input',e=>updateAll(e.target.value));
document.getElementById('applyHex').addEventListener('click',()=>updateAll(document.getElementById('hexInput').value.trim()));
document.getElementById('toggleColor').addEventListener('click',()=>{showElementColor=!showElementColor;updateAll(document.getElementById('colorInput').value)});

// Initial render
updateAll(document.getElementById('colorInput').value);
</script>
</body>
</html>
